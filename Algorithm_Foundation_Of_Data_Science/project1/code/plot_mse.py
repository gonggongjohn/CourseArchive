import matplotlib.pyplot as plt

x1 = [i for i in range(1, 200)]
y_pca = [405.44303293831166, 338.1228159773832, 272.6630710564412, 235.61029061959917, 214.8656124082468, 194.49776143069857, 180.49795714496872, 169.65257176182442, 160.3040450668741, 152.94256084859444, 146.29637061548326, 140.28366265436418, 134.93740089702553, 130.24566214262356, 125.77354588042952, 121.69873277403921, 117.83770525683654, 114.23220697546999, 110.88217523795605, 107.67465857786472, 104.60481020669987, 101.59860903113275, 98.647686112642, 95.87754329262172, 93.17243618242242, 90.58693367738185, 88.05170206403996, 85.60637832534707, 83.27059622009568, 81.01848345882588, 78.88925866342578, 76.79800218396404, 74.81201477300797, 72.864037388287, 70.9579651131171, 69.14181428948932, 67.37903125879816, 65.66401467299791, 63.973140645174475, 62.31216104847605, 60.6932257222709, 59.10838244859662, 57.56712475298837, 56.05826251084258, 54.59308708549626, 53.16860519291601, 51.791825249692465, 50.436647025960525, 49.13997594856725, 47.87739177820078, 46.649236583618546, 45.438191966299996, 44.27185645442204, 43.127271500288224, 42.01020500599481, 40.9228794836266, 39.84935411520841, 38.81558030201536, 37.81164900511557, 36.839149051667086, 35.889304489736894, 34.96689272562588, 34.07104617935678, 33.1912787841722, 32.33267646994377, 31.48784831040319, 30.658327284072723, 29.855933476949982, 29.076650346640918, 28.310607220170183, 27.568912606620454, 26.844137145910025, 26.141410092339594, 25.453327896867496, 24.785312582481808, 24.130089448513036, 23.48954308612905, 22.871566906678442, 22.268957882194314, 21.677496405688903, 21.097563993072555, 20.536756236683452, 19.99231004525797, 19.46544187117406, 18.94449620745383, 18.43492886767164, 17.93914538614003, 17.45087601332375, 16.97566286066917, 16.512421559213966, 16.05777435331842, 15.614401009851624, 15.187647318568212, 14.771372272395686, 14.364659992383826, 13.964949251393557, 13.577727288981592, 13.204745057635272, 12.837758160977641, 12.480177904575426, 12.131696395975197, 11.788306925154183, 11.455597852817363, 11.130867815602187, 10.80999412352694, 10.501348425404402, 10.204613421193118, 9.913847460787444, 9.630221567366783, 9.350663701479096, 9.079045256764392, 8.815351840099389, 8.558002381700314, 8.307575879221941, 8.06372323837885, 7.824220233931321, 7.5912782390632545, 7.366686237456101, 7.147421013521913, 6.933243951345159, 6.722575169668464, 6.5207859026626664, 6.322037956342444, 6.126774524020433, 5.938184611111665, 5.756443182635059, 5.5822040260150345, 5.412210814027541, 5.2465426225201, 5.083096485975227, 4.923007999771317, 4.766756150820128, 4.612863316350905, 4.464184783172191, 4.320846066518603, 4.18157478981525, 4.046805060139305, 3.9148540140898818, 3.7868096869526373, 3.6622033487952983, 3.539728641307894, 3.418564060514982, 3.3011531578636686, 3.1869480940975006, 3.076359076481238, 2.968754923157468, 2.8647988049962403, 2.76345385069182, 2.6652578772894375, 2.570469368131319, 2.4775803244493138, 2.3881952863952374, 2.301777684539911, 2.2181328673022604, 2.1369866068653, 2.0592418190308472, 1.9839699862366347, 1.910523362044324, 1.8395403619271995, 1.770203530676208, 1.7047586372894552, 1.6413220089479585, 1.5804133600581025, 1.520844519100228, 1.4634890942135639, 1.4071762756554158, 1.3522746542483395, 1.2999051258405656, 1.248583117365688, 1.198365882864697, 1.1498376776271737, 1.1027543869446308, 1.0575885476148912, 1.0134888484668774, 0.971290817370836, 0.930214952325028, 0.8904878268966293, 0.8523501964807368, 0.8160734476327827, 0.7804446284516953, 0.7462802052259704, 0.712961726652745, 0.6806974064565186, 0.6499679064000566, 0.6203089734779772, 0.5919357814930711, 0.5642507190662532, 0.5372208748755287, 0.5110453966695699, 0.48598109367618664, 0.46200607293832546, 0.4388731497318741, 0.4170039675398454, 0.39578496511611405, 0.3756542619883929, 0.35620388799338937, 0.33729848237571974, 0.31900041361708115, 0.3014087734285884]
y_2dpca = [99.40761820475261, 100.56553141276042, 99.5814208984375, 97.53195699055989, 97.89018249511719, 96.39762369791667, 96.99349975585938, 95.60551452636719, 94.72912089029948, 93.01532491048177, 92.83224995930989, 93.06264241536458, 92.40101623535156, 92.4854736328125, 91.83186848958333, 92.00523885091145, 90.13606770833333, 89.82203674316406, 88.94913736979167, 88.1146748860677, 87.79469807942708, 87.59246317545573, 87.69322713216145, 87.12757873535156, 86.64063008626302, 86.28940327962239, 85.93316141764323, 86.03515625, 84.85682169596355, 84.61128234863281, 84.32307942708333, 84.41428120930989, 83.98282877604167, 83.82830301920573, 83.20864868164062, 82.67474873860677, 81.89244079589844, 81.62244160970052, 81.1633809407552, 80.53494262695312, 80.39269510904948, 79.44108072916667, 79.39611307779948, 79.06035868326823, 78.28831990559895, 77.42388916015625, 76.69098409016927, 76.39195251464844, 76.33872477213542, 76.14442952473958, 75.80772399902344, 74.96956380208333, 74.41042073567708, 74.1559549967448, 73.45039367675781, 72.40981547037761, 72.3086649576823, 70.89684041341145, 70.46427917480469, 70.03707885742188, 68.78265380859375, 68.131591796875, 67.86499532063802, 67.53086344401042, 67.34964497884114, 66.55567932128906, 66.043701171875, 65.64125569661458, 65.18106079101562, 64.85911051432292, 64.47201538085938, 64.20067342122395, 63.713338216145836, 62.817708333333336, 62.5833994547526, 61.9672597249349, 61.39203898111979, 61.22366841634115, 60.54560343424479, 60.11853535970052, 59.73332214355469, 59.57475789388021, 59.275288899739586, 58.54927062988281, 58.41007995605469, 57.89417521158854, 57.158721923828125, 56.888875325520836, 55.423980712890625, 54.94495137532552, 54.412150065104164, 53.9440663655599, 53.18353271484375, 52.587432861328125, 52.01461283365885, 50.932271321614586, 50.66834513346354, 50.26201883951823, 49.99083964029948, 49.7474619547526, 49.41500345865885, 49.16296895345052, 48.77433776855469, 47.930389404296875, 47.602081298828125, 47.23664855957031, 45.70211283365885, 44.862630208333336, 44.383341471354164, 43.89156595865885, 43.34016418457031, 42.10990905761719, 41.36619567871094, 40.24905904134115, 39.24200439453125, 38.93479919433594, 37.886688232421875, 37.45905558268229, 37.238993326822914, 36.66492716471354, 36.2221425374349, 35.85650126139323, 35.29000345865885, 34.94255574544271, 34.46489969889323, 33.6119130452474, 33.2589365641276, 32.88395690917969, 32.573038736979164, 31.878194173177082, 31.663787841796875, 31.230982462565105, 30.91034444173177, 30.495473225911457, 30.167627970377605, 29.562896728515625, 27.832916259765625, 27.461873372395832, 27.118494669596355, 26.244486490885418, 25.610376993815105, 25.186136881510418, 24.841400146484375, 24.11730448404948, 23.71075948079427, 23.27777099609375, 22.787429809570312, 22.50128173828125, 22.09735616048177, 21.799270629882812, 21.30394999186198, 20.845484415690105, 20.37102762858073, 19.933258056640625, 19.517333984375, 18.98778788248698, 18.584386189778645, 17.950449625651043, 17.667007446289062, 17.340896606445312, 17.011688232421875, 16.716400146484375, 16.410186767578125, 16.14996846516927, 15.953420003255209, 15.690256754557291, 15.231745402018229, 14.402623494466146, 14.146794637044271, 13.641611735026041, 13.0745849609375, 12.876286824544271, 12.681599934895834, 12.468617757161459, 12.266866048177084, 12.035898844401041, 11.699549357096354, 11.495183308919271, 11.289576212565104, 11.0081787109375, 10.822906494140625, 10.669540405273438, 10.46026611328125, 10.303171793619791, 10.135686238606771, 10.008316040039062, 9.848622639973959, 9.494771321614584, 9.076761881510416, 8.771286010742188, 8.446604410807291, 8.1102294921875, 7.8353424072265625, 7.65972900390625, 7.5485382080078125, 7.318013509114583, 7.1839141845703125, 7.0224558512369795, 6.7977956136067705]
y_2d2dpca = [107.69473266601562, 107.74192301432292, 107.35910542805989, 107.48714192708333, 107.44038391113281, 104.17620849609375, 103.87047831217448, 103.8063456217448, 103.50135294596355, 103.23605346679688, 103.32902526855469, 103.57083129882812, 103.181640625, 101.65152486165364, 99.80100504557292, 99.35964457194011, 98.01243082682292, 98.08859761555989, 97.55699666341145, 97.06135559082031, 96.4260965983073, 96.03780110677083, 95.88350931803386, 95.77769470214844, 95.6282958984375, 95.89474487304688, 95.58055114746094, 95.42491658528645, 95.39008076985677, 95.16504414876302, 94.89884948730469, 94.95640563964844, 94.69386800130208, 94.36495463053386, 94.32310485839844, 93.3585713704427, 92.62597147623698, 91.71946716308594, 91.72593688964844, 91.157958984375, 91.19295247395833, 91.04194641113281, 90.9912618001302, 90.82142639160156, 90.72308349609375, 90.85680135091145, 90.67535909016927, 90.55080159505208, 90.24722290039062, 90.16053771972656, 89.72678629557292, 88.92209370930989, 88.74568684895833, 88.32303873697917, 88.29606119791667, 88.30482991536458, 87.80695088704427, 87.62089029947917, 86.84158325195312, 86.3858133951823, 86.55264790852864, 86.26977030436198, 86.24085489908855, 86.13797505696614, 86.24076843261719, 85.41085306803386, 85.15995788574219, 85.18264770507812, 84.96746826171875, 84.18827819824219, 84.35866800944011, 84.0144551595052, 83.33728535970052, 82.89222208658855, 82.69834899902344, 82.60587056477864, 82.76065572102864, 81.65501912434895, 81.13902791341145, 80.74702962239583, 80.19610087076823, 80.27640787760417, 80.04754130045573, 78.35117594401042, 77.86549886067708, 77.52782694498698, 77.62969462076823, 77.2528584798177, 76.82661946614583, 76.50828552246094, 76.51659138997395, 76.17873128255208, 75.48060099283855, 75.27630615234375, 74.78037007649739, 74.23954772949219, 74.06800333658855, 73.47527567545573, 73.04063924153645, 72.0045166015625, 71.0553690592448, 71.03482564290364, 70.38905334472656, 69.90484110514323, 69.29611714680989, 68.91451009114583, 68.8614501953125, 68.73226928710938, 68.0352274576823, 67.40849304199219, 67.0981953938802, 66.66739400227864, 66.32732645670573, 65.92322285970052, 65.3578592936198, 65.33193969726562, 64.97338358561198, 64.00054423014323, 63.30640157063802, 62.88763427734375, 62.623006184895836, 62.14484659830729, 61.90855407714844, 61.372578938802086, 59.963724772135414, 59.67839050292969, 59.125773111979164, 58.4149169921875, 58.17232767740885, 57.87286376953125, 56.96473185221354, 56.597330729166664, 56.40856424967448, 55.927469889322914, 55.72931416829427, 55.0868886311849, 54.75776163736979, 54.454559326171875, 54.20207722981771, 53.96243794759115, 53.17707824707031, 52.852315266927086, 52.57593282063802, 52.53446960449219, 52.289581298828125, 52.04117329915365, 51.808756510416664, 51.0851796468099, 50.77257283528646, 50.429178873697914, 49.26287841796875, 48.9522705078125, 47.715799967447914, 47.44585164388021, 47.08155314127604, 46.01347859700521, 45.77677917480469, 45.546305338541664, 44.7491709391276, 44.166035970052086, 43.15940856933594, 42.95319620768229, 42.67341105143229, 42.33386739095052, 41.30787658691406, 40.0123291015625, 39.49354553222656, 38.8779551188151, 38.234151204427086, 37.97107442220052, 36.833577473958336, 36.43176778157552, 35.68114725748698, 35.3934071858724, 35.150390625, 34.76496378580729, 34.40679931640625, 34.16493225097656, 33.7746327718099, 33.27147420247396, 31.029591878255207, 30.578877766927082, 30.153361002604168, 29.769236246744793, 29.352681477864582, 29.049524943033855, 28.766957600911457, 28.314626057942707, 28.002370198567707, 27.376988728841145, 27.131993611653645, 26.843577067057293, 26.51984151204427, 25.892161051432293, 25.65045166015625, 25.3828125, 25.035934448242188, 24.732213338216145, 24.19164530436198]
y_kpca = [478.3096591883149, 464.0839794350847, 455.9243646856676, 436.84998054068586, 427.18585215547046, 407.63986750827036, 396.13119856620386, 374.7944046156947, 378.7944046156947, 387.6204340797051, 370.8153883351785, 355.44452729075124, 339.89262127719286, 324.25330656978343, 309.0292506204807, 290.16584363971197, 274.38869321853923, 451.79528170216173, 440.9040986985871, 432.2096308814295, 423.79034865258296, 411.5660608540902, 398.2604936782655, 372.2006695303358, 356.2349634832838, 339.3365830947284, 324.01950053908513, 309.2762688413766, 294.0764351741316, 61.29303814293838, 53.75967323400493, 47.6413153695714, 44.524610725090575, 40.133149410614436, 35.62684556250807, 33.01865359432782, 30.687679043960966, 26.422457437044173, 25.20225460039337, 22.29611912550658, 20.873152294111225, 20.391608905585542, 18.943910780521644, 17.21060283488396, 15.75086798709417, 14.189279649394644, 13.423279558109487, 12.941273601867342, 12.356379559571318, 11.186844110287788, 10.08724010052074, 9.387490799309848, 7.964962823515216, 8.052565821698488, 7.567042170867475, 7.848338735781308, 6.82094789559688, 5.263565797991538, 5.520707646312803, 4.4129207387394525, 6.416687572511633, 3.322757941081042, 2.9820950748424644, 2.7364191897913503, 2.593583213543106, 2.5699289592709462, 2.3733286203845525, 2.2175012722135645, 2.226845867440566, 2.1253545540541787, 1.939468363708782, 1.819033681517327, 1.8641970313037752, 1.6793016732194752, 1.4214048835254454, 1.3164652325465942, 1.155610739193738, 1.1071243933417156, 1.070472839651958, 1.0392881241563596, 0.9799500652573697, 0.9406250711382574, 0.8899384299240819, 0.8627104722171102, 0.8879618128490687, 0.8656180360345688, 0.7846173508198793, 0.7820827415756303, 0.7274658418184264, 0.7124317083986241, 0.7097603314246848, 0.6881786544307236, 0.6763081280864237, 0.6654738228454228, 0.7066763345304213, 0.6933690128538373, 0.6412326774081482, 0.6444474031627104, 0.6388435022786536, 0.6079412498786675, 0.5951330011314456, 0.5869857802128122, 0.6015446884770012, 0.5860869422637182, 0.5622520809375201, 0.550956986471089, 0.5487843483743493, 0.5427989991047665, 0.5562094890086392, 0.561367567976441, 0.5357587941636462, 0.4750045710459616, 0.5178855632265397, 0.47940447450894674, 0.47853977027973843, 0.4597640483444603, 0.4589445390889204, 0.4512290280377164, 0.47420744679774013, 0.46200735278559585, 0.48828413741493554, 0.4453081500885631, 0.46519808671974533, 0.4541186752166735, 0.4451068705463728, 0.4680430615575259, 0.4692597530482722, 0.43640814229961383, 0.46233393605742706, 0.4194116878220317, 0.3593282732943794, 0.37425771619919174, 0.3712682315070739, 0.36133125929958604, 0.358966588324704, 0.33555487728817085, 0.3471149861107887, 0.32708793861774593, 0.3264258761779276, 0.3413455421938915, 0.3515471623499158, 0.33377913381418356, 0.33878769244230283, 0.3344601305447561, 0.3382794222603804, 0.22965204027849814, 0.21402509250633586, 0.20289188856823634, 0.19751708977962731, 0.2069344654191628, 0.1903620375398001, 0.1210758836852666, 0.11643220112213672, 0.11638691985082528, 0.18392542383271912, 0.1858568788033438, 0.18926511055636008, 0.17477438230839973, 0.17942847399451334, 0.1782249530596088, 0.16929451468395776, 0.17314138806963772, 0.18242741524498718, 0.18123526348598087, 0.17167768525592927, 0.17735394625450498, 0.17707313960469218, 0.17109453335494065, 0.1581385411007145, 0.1649297595698718, 0.15332983064138767, 0.1462529110351701, 0.11805015322252994, 0.1184192938833753, 0.11951383186569713, 0.11997160951044218, 0.11647108978354086, 0.11749302475820517, 0.09627486480356351, 0.08777201852413595, 0.08419189064594595, 0.06538459372538688, 0.08877486290620813, 0.08057562450437782, 0.10028110430812219, 0.17510992313049126, 0.1850825797281969, 0.17833807225786702, 0.1796267471855875, 0.1886339267867562, 0.16255692638609137, 0.1706902876044795, 0.1653636607101444, 0.17458248088561468, 0.16751605497795152, 0.0789131620295815, 0.09574520338750532, 0.06608145115318752, 0.08885075113055659]


# plt.semilogx()
plt.plot(x1, y_pca, label='PCA')
plt.plot(x1, y_2dpca, label='2DPCA')
plt.plot(x1, y_2d2dpca, label='2D-2DPCA')
plt.plot(x1, y_kpca, label='Kernel PCA')
# plt.xticks(x1, ['2^4', '2^8', '2^9', '2^10', '2^11'])
# plt.rcParams['font.sans-serif'] = ['STHeiti']
# plt.title('大顶堆实现的优先队列在不同数据规模下的运行时间比较')
plt.xlabel('K')
plt.ylabel('MSE')
plt.legend()
# ax = plt.gca()
# ax.spines['right'].set_color('none')
# ax.spines['top'].set_color('none')
plt.savefig('mse.png', dpi=300)
plt.show()
